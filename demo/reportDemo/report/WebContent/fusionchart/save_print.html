<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<TITLE>FusionCharts Free - Client Side Chart Plotting</TITLE>	
	<style type="text/css">
	<!--
	body {
		font-family: Arial, Helvetica, sans-serif;
		font-size: 12px;
	}
	-->
	</style>
	<SCRIPT LANGUAGE="Javascript" SRC="../js/FusionCharts.js"></SCRIPT>
	<SCRIPT LANGUAGE="Javascript" SRC="../js/jquery-1.4.4.min.js"></SCRIPT>
	<SCRIPT LANGUAGE="Javascript" SRC="../js/FusionChartsExportComponent.js"></SCRIPT>
	
	<SCRIPT LANGUAGE="JavaScript">
		var templatePath = "./swf/FCF_Column2D.swf";
		var saveTemplatePath = "./swf/FCExporter.swf";
		
		function report (){
			var myChart = new FusionCharts(templatePath, "myChartId", "400", "300", "0", "1");
            
            myChart.setXMLUrl('./xmlData/save.xml');
            myChart.render("chartContainer");

            var myExportComponent = new FusionChartsExportObject("fcExporter1", saveTemplatePath);
            myExportComponent.componentAttributes.btnColor = 'EAF4FD';
            myExportComponent.componentAttributes.btnBorderColor = '0372AB';
            myExportComponent.componentAttributes.btnFontFace = 'Verdana';
            myExportComponent.componentAttributes.btnFontColor = '0372AB';
            myExportComponent.componentAttributes.btnFontSize = '12';
            //Title of button
            myExportComponent.componentAttributes.btnsavetitle = '另存为'
            myExportComponent.componentAttributes.btndisabledtitle = '右键生成图片';

            
            myExportComponent.Render("fcexpDiv");

		}
		
	</SCRIPT>
</HEAD>
<BODY>
	<!-- START Script Block for Chart TopEmployees -->
	
    <div id="chartContainer" align="center">The chart will appear within this DIV. This text will be replaced by the chart.</div>
    <div id="fcexpDiv" align="center">FusionCharts Export Handler Component</div>

	<script language="JavaScript">					
		$(function() {
		    // The url for our json data
		    var jsonurl = "/report/AjaxServlet2";
	
		    $.ajax({
		        async: false,
		        url: jsonurl,
		        dataType: "json",
		        success: function(msg) {
		            report();           
				},
				error : function() {
				}
			});
	
		});
	</script>
		<BR />
	
</BODY>
</HTML>
